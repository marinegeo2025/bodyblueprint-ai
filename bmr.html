<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Êú¨Êù•„ÅÆÈù¢ÁõÆ, Honrai No Menmoku</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <nav>
      <ul>
        <li><a href="index.html">üè† Home</a></li>
        <li><a href="bmr.html">üèãÔ∏è BMR</a></li>
        <li><a href="weight.html">üìâ Weight</a></li>
        <li><a href="meals.html">üçΩÔ∏è Meals</a></li>
        <li><a href="chat.html">üí¨ AI Chat</a></li>
      </ul>
    </nav>
    <main>
      <section id="bmr" class="page">
        <h1>BMR & Calorie Goal</h1>
        <p>Calculate your Basal Metabolic Rate and set your calorie goal.</p>

        <!-- BMR Form -->
        <form id="bmrForm">
  <label for="age">Age:</label><br />
  <input type="number" id="age" required /><br /><br />

  <label for="gender">Gender:</label><br />
  <select id="gender">
    <option value="male">Male</option>
    <option value="female">Female</option>
  </select><br /><br />

  <label for="height">Height (cm):</label><br />
  <input type="number" id="height" required /><br /><br />

  <label for="weight">Weight (kg):</label><br />
  <input type="number" id="weight" required /><br /><br />

  <label for="activity">Training Frequency:</label><br />
  <select id="activity">
    <option value="low">Occasional</option>
    <option value="moderate">1-2x per week</option>
    <option value="high">5x per week</option>
  </select><br /><br />

  <button type="submit">Calculate TDEE</button>
</form>

<div id="bmrResults"></div>


        <!-- Cut / Bulk / Maintain Section -->
        <h2>Set Your Goal</h2>
        <p><strong>Suggested Ranges:</strong> Light cut/bulk: 250 kcal | Heavy cut/bulk: 500 kcal</p>
        <p><strong>Current Goal:</strong> <span id="goalDisplay">None</span></p>
        <p><strong>Target Calories:</strong> <span id="targetCalories">-</span> kcal</p>

        <label for="cutCalories">Cut:</label>
        <input type="number" id="cutCalories" placeholder="Enter deficit (e.g. 250)" />
        <button onclick="setGoal('cut')">Set Cut Goal</button>
        <br /><br />

        <label for="bulkCalories">Bulk:</label>
        <input type="number" id="bulkCalories" placeholder="Enter surplus (e.g. 250)" />
        <button onclick="setGoal('bulk')">Set Bulk Goal</button>
        <br /><br />

        <label for="maintainCalories">Maintain:</label>
        <input type="number" id="maintainCalories" placeholder="Adjust maintain kcal" />
        <button onclick="setGoal('maintain')">Set Maintain Goal</button>
      </section>

      <!-- Activity Level Section -->
      <section class="activity-level">
        <h2>Activity Level</h2>
        <label for="activity">Select your training frequency:</label>
        <select id="activity">
          <option value="low">Occasional</option>
          <option value="moderate">1-2x per week</option>
          <option value="high">5x per week</option>
        </select>
      </section>
    </main>

    <footer>
      <p>Êú¨Êù•„ÅÆÈù¢ÁõÆ, Honrai No Menmoku &copy; 2025</p>
    </footer>

    <script>
  document.addEventListener("DOMContentLoaded", function () {
    // ‚úÖ Load stored activity level on page load
    const storedActivity = localStorage.getItem("activity") || "moderate";
    document.getElementById("activity").value = storedActivity;

    // ‚úÖ Update activity level on change
    document.getElementById("activity").addEventListener("change", function () {
      localStorage.setItem("activity", this.value);
    });
  });

  document.getElementById("bmrForm").addEventListener("submit", function (event) {
    event.preventDefault();

    const age = parseInt(document.getElementById("age").value);
    const gender = document.getElementById("gender").value;
    const weight = parseFloat(document.getElementById("weight").value);
    const height = parseFloat(document.getElementById("height").value);
    const activityLevel = document.getElementById("activity").value; // ‚úÖ Get activity level

    if (!age || !weight || !height) {
        alert("Please enter all fields correctly.");
        return;
    }

    // ‚úÖ Calculate BMR
    let bmr;
    if (gender === "male") {
        bmr = 10 * weight + 6.25 * height - 5 * age + 5;
    } else {
        bmr = 10 * weight + 6.25 * height - 5 * age - 161;
    }

    // ‚úÖ Adjust BMR using Activity Level (TDEE Calculation)
    let activityMultiplier;
    switch (activityLevel) {
        case "low":
            activityMultiplier = 1.2; // Sedentary
            break;
        case "moderate":
            activityMultiplier = 1.375; // Lightly Active (1-2x per week)
            break;
        case "high":
            activityMultiplier = 1.55; // Very Active (5x per week)
            break;
        default:
            activityMultiplier = 1.375; // ‚úÖ Default to "moderate" if not selected
    }

    const tdee = bmr * activityMultiplier; // ‚úÖ TDEE Calculation

    document.getElementById("bmrResults").innerHTML = `
      <h2>Your Results</h2>
      <p><strong>BMR (Base):</strong> ${bmr.toFixed(2)} kcal/day</p>
      <p><strong>TDEE (with Activity):</strong> ${tdee.toFixed(2)} kcal/day</p>
    `;

    // ‚úÖ Store values in localStorage
    localStorage.setItem("bmr", bmr.toFixed(2));
    localStorage.setItem("tdee", tdee.toFixed(2)); // ‚úÖ Store TDEE instead of BMR
    localStorage.setItem("activity", activityLevel); // ‚úÖ Store activity level

    // ‚úÖ Update goal display
    updateGoalDisplay();
});

function updateGoalDisplay() {
    const goal = localStorage.getItem("goal") || "None";
    const tdee = localStorage.getItem("tdee") || "0"; // ‚úÖ Default to 0 if missing
    const activityLevel = localStorage.getItem("activity") || "moderate";

    document.getElementById("goalDisplay").innerText = goal;

    // ‚úÖ If no goal is set, use TDEE as target calories
    const targetCalories = localStorage.getItem("targetCalories") || tdee;
    document.getElementById("targetCalories").innerText = `${targetCalories} kcal/day`;

    // ‚úÖ Ensure dropdown reflects stored value
    document.getElementById("activity").value = activityLevel;
}

// ‚úÖ Ensure goal display updates on page load
updateGoalDisplay();

</script>

  </body>
</html>